<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>


<!--barra de navegacion-->

<app-barra-navegacion></app-barra-navegacion>

<!--Contenido y tablas-->

<section class="bienvenida-container">
    <div class="banner-container">
 
  <h2 class="mb-4 text-center titulo">Tabla de empleados</h2>
  <div class="mb-3 text-center">
  <input
    type="text"
    class="form-control w-50 mx-auto"
    placeholder="Buscar usuarios por nombre..."
    [(ngModel)]="terminoBusqueda"
    (input)="filtrarUsuarios()"
  />
</div>
  <div class="radio-group">
  <label class="radio-option">
    <input
      type="radio"
      name="filtroRol"
      [(ngModel)]="filtroRol"
      value="admin"
      (change)="filtrarUsuariosPorRol()"
    />
    Ver admin
  </label>

  <label class="radio-option">
    <input
      type="radio"
      name="filtroRol"
      [(ngModel)]="filtroRol"
      value="mesero"
      (change)="filtrarUsuariosPorRol()"
    />
    Ver mesero
  </label>

  <label class="radio-option">
    <input
      type="radio"
      name="filtroRol"
      [(ngModel)]="filtroRol"
      value="comensal"
      (change)="filtrarUsuariosPorRol()"
    />
    Ver comensal
  </label>

  <label class="radio-option">
    <input
      type="radio"
      name="filtroRol"
      [(ngModel)]="filtroRol"
      value=""
      (change)="filtrarUsuariosPorRol()"
    />
    Ver todos
  </label>
</div>
  <form *ngIf="mostrarFormulario" (ngSubmit)="crearEmpleado()" #formEmpleado="ngForm" class="mt-3">
  <div class="mb-2">
    <label>Nombre:</label>
    <input [(ngModel)]="nuevoEmpleado.name" name="nombre" class="form-control" required />
  </div>
  <div class="mb-2">
    <label>Correo:</label>
    <input [(ngModel)]="nuevoEmpleado.email" name="email" type="email" class="form-control" required />
  </div>
  <div class="mb-2">
    <label>Contrase√±a:</label>
    <input [(ngModel)]="nuevoEmpleado.password" name="password" type="password" class="form-control" required />
  </div>
  <div class="mb-3">
    <label>Rol:</label>
    <select [(ngModel)]="nuevoEmpleado.role" name="role" class="form-control" required>
      <option value="admin">Administrador</option>
      <option value="comensal">Comensal</option>
      <option value="mesero">Mesero</option>
    </select>
  </div>
  <button class="btn btn-success" type="submit">Guardar empleado</button>
  
</form>
  <button class="btn btn-sm btn-primary" (click)="mostrarFormulario = !mostrarFormulario">
  {{ mostrarFormulario ? 'Cancelar' : 'Nuevo empleado' }}
</button>

  <table class="table table-striped table-bordered table-hover">
    <thead class="table-dark">
      <tr>
        <th>ID</th>
        <th>Nombre</th>
        <th>Email</th>
        <th>Rol</th>
        <th>Acciones</th>
      </tr>
    </thead>
    <tbody>
  <tr *ngFor="let usuario of usuariosPaginados">
    <td>{{ usuario.id }}</td>
    
    <!-- Nombre -->
    <td *ngIf="!usuario.editando">{{ usuario.name }}</td>
    <td *ngIf="usuario.editando">
      <input [(ngModel)]="usuario.name" class="form-control form-control-sm" />
    </td>

    <!-- Email -->
    <td *ngIf="!usuario.editando">{{ usuario.email }}</td>
    <td *ngIf="usuario.editando">
      <input [(ngModel)]="usuario.email" class="form-control form-control-sm" />
    </td>

    <!-- Rol -->
    <td *ngIf="!usuario.editando">
  {{ usuario.roles.length > 0 ? usuario.roles.join(', ') : 'Sin rol' }}
</td>
    <td *ngIf="usuario.editando">
  <select [(ngModel)]="usuario.roles" class="form-control form-control-sm">
    <option value="admin">Administrador</option>
    <option value="comensal">Comensal</option>
    <option value="mesero">Mesero</option>
  </select>
</td>

    <!-- Acciones -->
    <td>
      <button *ngIf="!usuario.editando" (click)="editarUsuario(usuario)" class="btn btn-sm btn-warning me-2">Editar</button>
      <button *ngIf="usuario.editando" (click)="guardarUsuario(usuario)" class="btn btn-sm btn-success me-2">Guardar</button>
      <button *ngIf="usuario.editando" (click)="cancelarEdicion(usuario)" class="btn btn-sm btn-secondary me-2">Cancelar</button>
      <button (click)="eliminarUsuario(usuario.id)" class="btn btn-sm btn-danger">Eliminar</button>
    </td>
  </tr>
</tbody>
  </table>
  <nav class="d-flex justify-content-center mt-3">
  <ul class="pagination">
    <li class="page-item" [class.disabled]="paginaActualUsuarios === 1">
      <button class="page-link" (click)="cambiarPaginaUsuarios(paginaActualUsuarios - 1)">Anterior</button>
    </li>

    <li 
      class="page-item" 
      *ngFor="let pagina of [].constructor(totalPaginasUsuarios()); let i = index"
      [class.active]="paginaActualUsuarios === i + 1">
      <button class="page-link" (click)="cambiarPaginaUsuarios(i + 1)">{{ i + 1 }}</button>
    </li>

    <li class="page-item" [class.disabled]="paginaActualUsuarios === totalPaginasUsuarios()">
      <button class="page-link" (click)="cambiarPaginaUsuarios(paginaActualUsuarios + 1)">Siguiente</button>
    </li>
  </ul>
</nav>
 
  </div>
</section>