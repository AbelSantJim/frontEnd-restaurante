<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>


<!--Barra de navegacion-->
<app-barra-navegacion></app-barra-navegacion>

<!---->
<section class="bienvenida-container ">
  <div class="banner-container bg-dark p-4 rounded shadow">
    <h2 class="text-white mb-4">Administración de Órdenes</h2>
    <div class="radio-group">
  <label class="radio-option">
    <input type="radio" name="filtroEstado" [(ngModel)]="filtroEstado" value="pendiente" (change)="filtrarPedidos()" />
    Mostrar pendientes
  </label>

  <label class="radio-option">
    <input type="radio" name="filtroEstado" [(ngModel)]="filtroEstado" value="entregado" (change)="filtrarPedidos()" />
    Mostrar entregados
  </label>

  <label class="radio-option">
    <input type="radio" name="filtroEstado" [(ngModel)]="filtroEstado" value="pagado" (change)="filtrarPedidos()" />
    Mostrar pagados
  </label>

  <label class="radio-option">
    <input type="radio" name="filtroEstado" [(ngModel)]="filtroEstado" value="" (change)="filtrarPedidos()" />
    Mostrar todos
  </label>
</div>
    <div class="table-responsive">
      <table class="table table-striped table-hover table-bordered bg-white rounded">
        <thead class="table-dark text-center">
          <tr>
            <th>ID pedido</th>
            <th>Mesa</th>
            <th>Usuario</th>
            <th>Total</th>
            <th>Estado</th>
            <th>Fecha</th>
            <th>Acciones</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let pedido of paginatedPedidos">
            <td>{{ pedido.id }}</td>
            <td>{{ pedido.mesa_id }}</td>
            <td>{{ pedido.user_id }}</td>
            <td>$ {{ pedido.total }}</td>
            <td>
              <span 
                class="badge"
                [ngClass]="{
                  'bg-success': pedido.estado === 'pagado',
                  'bg-danger': pedido.estado === 'cancelado',
                  'bg-warning text-dark': pedido.estado === 'pendiente',
                  'btn btn-primary': pedido.estado === 'entregado'
                }">
                {{ pedido.estado }}
              </span>
            </td>
            <td>{{ pedido.created_at | date: 'short' }}</td>
            <td class="text-center">
  <button 
    class="btn me-2"
    [ngClass]="{
       'btn-warning': pedido.estado === 'pendiente',
  'btn-success': pedido.estado === 'entregado',
  'btn-danger': pedido.estado === 'pagado',
  'btn-secondary': pedido.estado === 'cancelado'
    }"
    [disabled]="pedido.estado === 'pagado' && rol !== 'admin'"
    (click)="accionPedido(pedido)">
    {{
      pedido.estado === 'pendiente' ? 'Entregar' :
      pedido.estado === 'entregado' ? 'Cobrar' :
      pedido.estado === 'pagado' ? 'Cancelado' : ''
    }}
  </button>
</td>
          </tr>
        </tbody>
      </table>
      <nav class="d-flex justify-content-center mt-3">
  <ul class="pagination">
    <li class="page-item" [class.disabled]="currentPage === 1">
      <a class="page-link" (click)="prevPage()">Anterior</a>
    </li>

    <li 
      class="page-item" 
      *ngFor="let page of [].constructor(totalPages); let i = index"
      [class.active]="currentPage === (i + 1)">
      <a class="page-link" (click)="cambiarPagina(i + 1)">{{ i + 1 }}</a>
    </li>

    <li class="page-item" [class.disabled]="currentPage === totalPages">
      <a class="page-link" (click)="nextPage()">Siguiente</a>
    </li>
  </ul>
</nav>
      </div>
  </div>
</section>